"use strict";(self.webpackChunkinnova_ipr=self.webpackChunkinnova_ipr||[]).push([[196],{3196:function(e,n,r){r.r(n),r.d(n,{default:function(){return k}});var t=r(5893),a=r(2553),i=r(7536),s=r(5807),o=r(7180);let c=(e=21)=>crypto.getRandomValues(new Uint8Array(e)).reduce(((e,n)=>e+((n&=63)<36?n.toString(36):n<62?(n-26).toString(36).toUpperCase():n>62?"-":"_")),"");var l=r(3166),u=r(4425),f=r(7003),d=r(8499),p=r(2691),h=function(){var e=(0,i.cI)(),n=e.register,r=e.handleSubmit,a=e.reset,h=(0,u.s)(),v=(0,f.C)((function(e){return e.user})),m=v.user,g=v.authData,b=function(e){var n=e.message;n&&""!==n.trim()&&(h.emit("send_message",{message:n,id:c(),sender:(null==m?void 0:m.firstName)||(null==m?void 0:m.username),senderId:null==g?void 0:g.id}),a())};return(0,t.jsxs)("form",{name:"formMessage",onSubmit:r(b),className:"LFx5lNsf",children:[(0,t.jsx)(s.Z,{title:"Для быстрой вставки текста и отправки сообщения кликните два раза",style:{width:"100%"},children:(0,t.jsx)(l.I,{fieldName:"message",register:n,id:"message",className:"fk1qlI4S",rules:{required:!0},autoComplete:"off",placeholder:"Введите сообщение...",onDoubleClick:function(){return e=void 0,n=void 0,t=function(){var e;return function(e,n){var r,t,a,i,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:o(0),throw:o(1),return:o(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function o(o){return function(c){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;i&&(i=0,o[0]&&(s=0)),s;)try{if(r=1,t&&(a=2&o[0]?t.return:o[0]?t.throw||((a=t.return)&&a.call(t),0):t.next)&&!(a=a.call(t,o[1])).done)return a;switch(t=0,a&&(o=[2&o[0],a.value]),o[0]){case 0:case 1:a=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,t=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!((a=(a=s.trys).length>0&&a[a.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!a||o[1]>a[0]&&o[1]<a[3])){s.label=o[1];break}if(6===o[0]&&s.label<a[1]){s.label=a[1],a=o;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(o);break}a[2]&&s.ops.pop(),s.trys.pop();continue}o=n.call(e,s)}catch(e){o=[6,e],t=0}finally{r=a=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,c])}}}(this,(function(n){switch(n.label){case 0:return[4,p.T.pasteText()];case 1:return e=n.sent(),b({message:e}),[2]}}))},new((r=void 0)||(r=Promise))((function(a,i){function s(e){try{c(t.next(e))}catch(e){i(e)}}function o(e){try{c(t.throw(e))}catch(e){i(e)}}function c(e){var n;e.done?a(e.value):(n=e.value,n instanceof r?n:new r((function(e){e(n)}))).then(s,o)}c((t=t.apply(e,n||[])).next())}));var e,n,r,t}})}),(0,t.jsx)(d.h,{label:"Фото",onChange:function(e){var n=new FileReader,r=e.target.files[0];r&&(n.onload=function(e){var n=e.target.result;h.emit("send_message",{message:"",id:c(),sender:(null==m?void 0:m.firstName)||(null==m?void 0:m.username),senderId:null==g?void 0:g.id,file:n})},n.readAsDataURL(r))}}),(0,t.jsx)(o.ZP,{htmlType:"submit",children:"Отправить"})]})},v=r(7294),m=r(4184),g=r.n(m),b=r(1659),x=r(6373),y=function(e,n,r){if(r||2===arguments.length)for(var t,a=0,i=n.length;a<i;a++)!t&&a in n||(t||(t=Array.prototype.slice.call(n,0,a)),t[a]=n[a]);return e.concat(t||Array.prototype.slice.call(n))},j=function(){var e=(0,v.useState)([]),n=e[0],r=e[1],a=(0,u.s)(),i=(0,x.a)().id;return(0,v.useEffect)((function(){a.on("receive_message",(function(e){r((function(n){return y(y([],n,!0),[e],!1)}))}))}),[]),(0,t.jsx)("div",{className:"etkvg7Eo",children:n.map((function(e){var n=e.message,r=e.id,a=e.sender,s=e.senderId,o=e.file;return(0,t.jsxs)("div",{className:g()("lSut7kJu",i===s?"e0Wvq6lv":"tGLeh5KS"),children:[(0,t.jsx)("p",{children:"".concat(a,": ").concat(n)}),o&&(0,t.jsx)(b.Z,{src:o,alt:"file",width:200})]},r)}))})},w=function(){return(0,t.jsxs)("div",{className:"DTt5MrHd",children:[(0,t.jsx)(j,{}),(0,t.jsx)(h,{})]})},N=r(2216),k=function(){return(0,t.jsx)(N.T,{children:(0,t.jsx)(a.X2,{className:"cnMZBi0i",children:(0,t.jsx)(a.JX,{className:"DDoSEsk3",children:(0,t.jsx)(w,{})})})})}},2691:function(e,n,r){r.d(n,{T:function(){return t}});var t={copyText:function(e){return navigator.clipboard.writeText(e).then((function(e){return e})).catch((function(e){return console.error(e),""}))},pasteText:function(){return navigator.clipboard.readText().then((function(e){return e})).catch((function(e){return console.error(e),""}))}}},8499:function(e,n,r){r.d(n,{h:function(){return a}});var t=r(5893),a=function(e){var n=e.accept,r=void 0===n?"image/png, image/jpeg":n,a=e.onChange,i=e.label,s=void 0===i?"Выберите файл":i;return(0,t.jsxs)("label",{className:"rZNh8Dm5",children:[s,(0,t.jsx)("input",{type:"file",accept:r,onChange:a,className:"luYGfs7s"})]})}},3166:function(e,n,r){r.d(n,{I:function(){return o}});var t=r(5893),a=r(4184),i=r.n(a),s=function(){return s=Object.assign||function(e){for(var n,r=1,t=arguments.length;r<t;r++)for(var a in n=arguments[r])Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a]);return e},s.apply(this,arguments)},o=function(e){var n,r=e.fieldName,a=e.id,o=e.register,c=e.rules,l=void 0===c?{}:c,u=e.label,f=e.error,d=e.className,p=e.isProfile,h=void 0!==p&&p,v=function(e,n){var r={};for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&n.indexOf(t)<0&&(r[t]=e[t]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(t=Object.getOwnPropertySymbols(e);a<t.length;a++)n.indexOf(t[a])<0&&Object.prototype.propertyIsEnumerable.call(e,t[a])&&(r[t[a]]=e[t[a]])}return r}(e,["fieldName","id","register","rules","label","error","className","isProfile"]);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("label",{htmlFor:a,children:u}),(0,t.jsxs)("div",{className:"qB7FoCJj",children:[(0,t.jsx)("input",s({},o(r,s({},l)),{id:a,className:i()("LVdIPwcx",d)},v)),f&&(0,t.jsx)("p",{className:i()((n={},n.LHeVUdIV=h,n),"BgTYZ9zp"),children:f||"Ошибка"})]})]})}},2216:function(e,n,r){r.d(n,{T:function(){return o}});var t=r(5893),a=r(7294),i=r(4184),s=r.n(i),o=function(e){var n=e.className,r=e.children,i=e.onScrollEnd,o=(0,a.useRef)(),c=(0,a.useRef)();return function(e){var n=e.callback,r=e.wrapperRef,t=e.triggerRef,i=(0,a.useRef)(null);(0,a.useEffect)((function(){var e=t.current;return n&&(i.current=new IntersectionObserver((function(e){e[0].isIntersecting&&n()}),{root:null,rootMargin:"0px",threshold:1}),i.current.observe(e)),function(){i.current&&e&&i.current.unobserve(e)}}),[r,t,n])}({triggerRef:c,wrapperRef:o,callback:i}),(0,t.jsxs)("section",{ref:o,className:s()("GbBEaO_D",n),children:[r,(0,t.jsx)("div",{ref:c})]})}}}]);